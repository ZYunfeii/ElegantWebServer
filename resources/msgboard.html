<!--
 * @Author       : mark
 * @Date         : 2020-06-30
 * @copyleft GPL 2.0
-->
<!DOCTYPE html>
<html lang="en">

<head>

     <meta charset="UTF-8">

     <title>留言栏</title>
     <link rel="icon" href="images/favicon.ico">
     <link rel="stylesheet" href="css/bootstrap.min.css">
     <link rel="stylesheet" href="css/animate.css">
     <link rel="stylesheet" href="css/magnific-popup.css">
     <link rel="stylesheet" href="css/font-awesome.min.css">

     <!-- Main css -->
     <link rel="stylesheet" href="css/style.css">

     <style>
          #box{
              width: 800px;
              margin: 50px auto;
              /*border: 1px solid red;*/
          }
          #box textarea{
              width: 100%;
              height: 300px;
              font-size: 30px;
          }
          li{
              list-style: none;
              height: 40px;
              line-height: 40px;
              /*加个下划线*/
              border-bottom: 1px solid grey;
          }
      </style>

</head>

<body data-spy="scroll" data-target=".navbar-collapse" data-offset="50">

     <!-- PRE LOADER -->
     <div class="preloader">
          <div class="spinner">
               <span class="spinner-rotate"></span>
          </div>
     </div>


     <!-- NAVIGATION SECTION -->
     <div class="navbar custom-navbar navbar-fixed-top" role="navigation">
          <div class="container">

               <div class="navbar-header">
                    <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                         <span class="icon icon-bar"></span>
                         <span class="icon icon-bar"></span>
                         <span class="icon icon-bar"></span>
                    </button>
                    <!-- lOGO TEXT HERE -->
                    <a href="/blogindex" class="navbar-brand">Xuan</a>
               </div>
               <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                         <li><a class="smoothScroll" href="/">首页</a></li>
                         <li><a class="smoothScroll" href="/cpp">C++笔记</a></li>
                         <li><a class="smoothScroll" href="/msgboard"><font color="#FF0000">留言栏</font></a></li>
                         <li><a class="smoothScroll" href="/blogindex">云飞的博客</a></li>
                         <li><a class="smoothScroll" href="/picture">图片</a></li>
                         <li><a class="smoothScroll" href="/video">视频</a></li>
                         <li><a class="smoothScroll" href="/fileupload">上传</a></li>
                         <li><a class="smoothScroll" href="/filedownload">下载</a></li>
                         <li><a class="smoothScroll" href="/login">登录</a></li>
                         <li><a class="smoothScroll" href="/register">注册</a></li>
                    </ul>
               </div>

          </div>
     </div>
     <!-- HOME SECTION -->
     <br />
     <br />
     <div id="box">
          <textarea class="text" name="" id="" cols="30" rows="10"></textarea>
          <button class="but">发布</button>
          <ul class="list"></ul>
     </div>

     <script>
          var oText = document.getElementsByClassName("text")[0];
              oBut = document.getElementsByClassName("but")[0];
              oList = document.getElementsByClassName("list")[0];
      
          oBut.onclick = function () {
               val = oText.value;
               oText.value = "";
               oList.innerHTML += "<li>" + val + "</li>"
               const xhr = new XMLHttpRequest();
               xhr.open('GET', '/set-comments/' + val);
               xhr.send();
               xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                         if (xhr.status >= 200 && xhr.status < 300) {
                              console.log(xhr.response);
                         }
                    }
               }
          }

          window.onload = function() {
               const xhr = new XMLHttpRequest();
               xhr.open('GET', '/get-comments');
               xhr.responseType = "text";
               xhr.send();
               xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                         if (xhr.status >= 200 && xhr.status < 300) {
                              var text = window.decodeURIComponent(xhr.response);
                              oList.innerHTML += text;
                              console.log(xhr.response);
                         }
                    }
               }
          }
      </script>

     <!-- SCRIPTS -->
     <script src="js/jquery.js"></script>
     <script src="js/bootstrap.min.js"></script>
     <script src="js/smoothscroll.js"></script>
     <script src="js/jquery.magnific-popup.min.js"></script>
     <script src="js/magnific-popup-options.js"></script>
     <script src="js/wow.min.js"></script>
     <script src="js/custom.js"></script>
</body>

</html>